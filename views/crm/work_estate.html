{% extends 'crm/db_base.html' %}

{% block dbmanage_content %}

<style>
    @media screen and (max-width: 992px) {
        .table_wrap {
            width: 100%;
            overflow: auto;
        }

        .table_area {
            width: 100%;
            min-width: 800px;
        }
    }
</style>

<!-- {% for i in range(2,7) %}
{{i}}
{% endfor %} -->
<!-- <a href="?pnum=3">sdfsdf</a> -->

<div class="container">
    <form>
        <div class="my-4">

            <select name="est" id="" class="py-1 pr-14 text-sm border-blue-500 rounded-lg">
                <option value="">전체선택</option>
                {% for estate in all_data.estate_list %}

                {% if all_data.est == estate %}
                <option value="{{estate}}" selected>{{estate}}</option>
                {% else %}
                <option value="{{estate}}">{{estate}}</option>
                {% endif %}

                {% endfor %}
            </select>

            <button type="submit" class="ml-2 text-sm py-1 px-4 bg-gray-700 text-white rounded-lg">검색</button>

        </div>
        <div class="table_wrap">
            <div class="table_area">
                <table class="border-collapse border border-slate-400 w-full text-sm suit-font">
                    <tr>
                        <th class="border border-slate-300 text-center">
                            <input type="checkbox" name="" id="" class="all_chk">
                        </th>
                        <th class="border border-slate-300 py-2 text-center">접수번호</th>
                        <th class="border border-slate-300 py-2 text-center">고객명</th>
                        <th class="border border-slate-300 py-2 text-center">전화번호</th>
                        <th class="border border-slate-300 py-2 text-center">비고</th>
                        <th class="border border-slate-300 py-2 text-center">상태</th>
                        <th class="border border-slate-300 py-2 text-center">접수 시간</th>
                    </tr>

                    {% for data in all_data.wdata %}
                    <tr>
                        <td class="border border-slate-300 text-center">
                            <input type="checkbox" name="" id="" class="on_chk">
                        </td>
                        <td class="border border-slate-300 py-2 text-center">{{ data.chkCount }}</td>
                        <td class="border border-slate-300 py-2 text-center"> {{ data.mb_name }} </td>
                        <td class="border border-slate-300 py-2 text-center">{{ data.mb_phone_chk }} </td>
                        <td class="border border-slate-300 py-2 text-center px-3">
                            {{ data.form_name }}
                        </td>
                        <td class="border border-slate-300 py-2 text-center px-3">준비중</td>
                        <td class="border border-slate-300 py-2 text-center px-3 created_time">{{ data.created_at |
                            date("YY/MM/DD HH:mm:ss") }}</td>
                    </tr>
                    {% endfor %}


                </table>
            </div>


            <nav aria-label="Page navigation example" class="text-center mt-4">
                <ul class="inline-flex items-center -space-x-px mx-auto">
                    <li>
                        <button type="button"
                            class="block py-2 px-3 ml-0 leading-tight text-gray-500 bg-white rounded-l-lg border border-gray-300 move_page prev">
                            <span class="sr-only">Previous</span>
                            <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                                xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd"
                                    d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </button>
                    </li>

                    {% for i in range(all_data.pagingStartCount, all_data.pagingEndCount) %}
                    {% if i == all_data.nowCount %}
                    <li><button type="submit" name="pnum" value="{{i}}"
                            class="py-2 px-3 leading-tight text-gray-500 bg-blue-300 border border-gray-300">{{i}}</button>
                    </li>
                    {% else %}
                    <li><button type="submit" name="pnum" value="{{i}}"
                            class="py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300">{{i}}</button>
                    </li>
                    {% endif %}
                    {% endfor %}



                    <li>
                        <button type="button"
                            class="block py-2 px-3 leading-tight text-gray-500 bg-white rounded-r-lg border border-gray-300 move_page next">
                            <span class="sr-only">Next</span>
                            <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                                xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd"
                                    d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </button>
                    </li>
                </ul>
            </nav>
        </div>
    </form>
</div>

<script>

    $('.move_page').click(function (e) {
        const URLSearch = new URLSearchParams(location.search);
        console.log(URLSearch);
    })


    $('.all_chk').change(function (e) {
        console.log(this.checked);
        if (this.checked == true) {
            document.querySelectorAll('.on_chk').forEach(e => {
                e.checked = true;
            });
        } else {
            document.querySelectorAll('.on_chk').forEach(e => {
                e.checked = false;
            });
        }
    })
    var created_time = document.querySelectorAll('.created_time')
    created_time.forEach(element => {
    });

</script>
{% endblock %}